The Data Model of a Cloud Fleet Blimp
====================================

## Types of Data

1. Application
2. Cloudfleet Configuration
3. Blimp Encryption Key
4. User Data

### 1. Application Data

#### What is it

Everything the Application needs to run inside the cloudfleet environment.
(Including configuration where the data is stored)
This is only updated when application is updated.

#### Where is it stored

This data is stored in the docker image for the application

### 2. Cloudfleet Configuration

#### What is it

This contains everything necessary for the blimp to connect to the cloudfleet network. 

This consists of the domain name of the blimp and the authentication of the blimp for
the cloudfleet services.

The domain name is exposed to the apps as the environment variable BLIMP_DOMAIN.

Initially the authentication is a preshared key that identifies the box. It is shared with the user management application as the environment variable BLIMP_SECRET. Later it is replaced by the 
SSL key pair generated by the box and signed via cloudfleet.

#### Where is it stored

This data is stored on the root file system of the box, and is part of the backup.

### 3. Blimp Encryption Key

#### What is it

This contains the key for the disk encryption and the backup. 

#### Where is it stored

This data MUST NOT be stored on disk. It will be stored on a USB key the user plugs in on first start.


### 4. User Data 

#### What is it

Every application will get a dedicated space to store its data. 


#### Where is it stored

To store data the application will have access to three possibilities:

- a sandboxed directory on the file system
- a database on the postgresql server
- a database on the couchDB server

All of these are part of the backup.


## Interaction Between Apps

Every app will expose an HTTP API to give other apps access to its data. Apps that need access to
another app's data will be linked to the container.

There might be special cases where multiple apps need access to the same raw storage (filesystem, database).
This will only allowed for core apps that are vetted by the cloudfleet team.

## Interfaces to the outside

Every app that exposes a web interface will be assigned a port number starting with 10001. 
The web interface will then be available under https://\<domainname\>/\<app-name\>
